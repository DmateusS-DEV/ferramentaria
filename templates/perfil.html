{% extends "base.html" %}
{% block title %}Meu perfil{% endblock %}
{% block body_class %}page--dashboard{% endblock %}

{% block content %}
<section class="edit-shell">
  <header class="edit-header">
    <h1 class="page-title" style="text-align:center;">Meu perfil</h1>
    <div class="page-subtitle" style="text-align:center;">
      Veja seus dados e altere sua senha.
    </div>
  </header>

  <form method="post" class="edit-form center-narrow">
    <!-- Dados -->
    <div class="card" style="padding:16px;">
      <div class="form-grid">
        <div class="form-field">
          <label for="nome">Nome</label>
          <input id="nome" name="nome" class="input" value="{{ u.nome }}" required>
        </div>

        <div class="form-field">
          <label for="email">E-mail</label>
          <input id="email" name="email" type="email" class="input"
                 value="{{ u.email }}" {{ '' if is_admin else 'readonly' }}>
        </div>

        <div class="form-field">
          <label>Perfil</label>
          <input class="input" value="{{ u.perfil|capitalize }}" readonly>
        </div>

        <div class="form-field">
          <label for="centro_custo">Centro de custo</label>
          <input id="centro_custo" name="centro_custo" class="input"
                 value="{{ u.centro_custo or '' }}" {{ '' if is_admin else 'readonly' }}>
        </div>

        <div class="form-field">
          <label for="funcao">Função</label>
          <input id="funcao" name="funcao" class="input"
                 value="{{ u.funcao or '' }}" {{ '' if is_admin else 'readonly' }}>
        </div>
      </div>
    </div>

    <!-- Alterar senha -->
    <div class="card" style="padding:16px;margin-top:16px;">
      <h3 class="page-subtitle" style="margin:0 0 8px;">Alterar senha</h3>
      <div class="form-grid">
        <div class="form-field">
          <label for="senha_atual">Senha atual</label>
          <input id="senha_atual" name="senha_atual" type="password" class="input" autocomplete="current-password">
        </div>

        <div class="form-field">
          <label for="nova_senha">Nova senha</label>
          <input id="nova_senha" name="nova_senha" type="password" class="input"
                 minlength="6" placeholder="mín. 6 caracteres" autocomplete="new-password">
        </div>

        <div class="form-field">
          <label for="confirma_senha">Confirmar nova senha</label>
          <input id="confirma_senha" name="confirma_senha" type="password" class="input"
                 placeholder="repita a nova senha" autocomplete="new-password">
        </div>
      </div>

      <!-- Ações: Voltar + Salvar lado a lado -->
      <div class="form-actions">
        <a class="btn btn--outline" href="{{ request.referrer or url_for('index') }}">← Voltar</a>
        <button class="btn btn--primary" type="submit">Salvar nova senha</button>
      </div>
    </div>
  </form>
</section>
{% endblock %}